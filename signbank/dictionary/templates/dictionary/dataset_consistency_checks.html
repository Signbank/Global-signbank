{% extends 'baselayout.html' %}
{% load i18n %}
{% load stylesheet %}
{% load annotation_idgloss_translation %}
{% load has_group %}
{% load bootstrap3 %}

{% load guardian_tags %}


{% block extrajs %}
<script type='text/javascript'>
var url = '{{PREFIX_URL}}';
</script>

{% endblock %}

{% block bootstrap3_title %}
{% blocktrans %}Manage Dataset Video Storage{% endblocktrans %}
{% endblock %}

{% block content %}
<div>
<h3>{% trans "Manage Dataset Video Storage" %}</h3>

    <table class='table table-condensed table-condensed-light'>
    <tr><th style="width:300px;">{% trans "Dataset name" %}</th><td style="width:1200px;">{{dataset.name}}</td></tr>
    <tr><th>{% trans "Acronym" %}</th><td>{{dataset.acronym}}</td></tr>
    <tr><th>{% trans "Number of glosses" %}</th><td>{{nr_of_glosses}} total</td></tr>
    </table>
    <br>

    <h4>{% trans "Glosses with Multiple Version 0 Videos" %}</h4>
    <p>{{glosses_with_too_many_videos|length}} {% trans "results found" %}</p>
    {% if glosses_with_too_many_videos %}
    <table class='table table-condensed table-condensed-light'>
    <tr>
        <th style="width:300px;">{% trans "Lemma" %} ({{default_language.name}})</th>
        <th style="width:100px;">{% trans "Gloss ID" %}</th>
        {% for language in dataset_languages %}
        <th style="width:300px;">{% trans "Annotation" %} ({{language.name}})</th>
        {% endfor %}
        <th style="width:1000px;">{% trans "Video Paths" %}</th></tr>
        {% for gloss, videos in glosses_with_too_many_videos %}
        <tr>
            <td>{{gloss.idgloss}}</td>
            <td>{{gloss.id}}</td>
            {% for language in dataset_languages %}
            <td>{{gloss|get_annotation_idgloss_translation_no_default:language}}</td>
            {% endfor %}
            <td>{{videos}}</td></tr>
        {% endfor %}
    </table>
    {% endif %}
    <br>

    <h4>{% trans "Glosses with Extra Characters in Video Filenames" %}</h4>
    <p>{{glosses_with_weird_filenames|length}} {% trans "results found" %}</p>
    {% if glosses_with_weird_filenames %}
    <table class='table table-condensed table-condensed-light'>
    <tr>
        <th style="width:300px;">{% trans "Lemma" %} ({{default_language.name}})</th>
        <th style="width:100px;">{% trans "Gloss ID" %}</th>
        {% for language in dataset_languages %}
        <th style="width:300px;">{% trans "Annotation" %} ({{language.name}})</th>
        {% endfor %}
        <th style="width:1000px;">{% trans "Video Paths" %}</th></tr>
        {% for gloss, videos in glosses_with_weird_filenames %}
        <tr>
            <td>{{gloss.idgloss}}</td>
            <td>{{gloss.id}}</td>
            {% for language in dataset_languages %}
            <td>{{gloss|get_annotation_idgloss_translation_no_default:language}}</td>
            {% endfor %}
            <td>{{videos}}</td></tr>
        {% endfor %}
    </table>
    {% endif %}
    <br>

    <h4>{% trans "Glosses with Wrong Folder for Video" %}</h4>
    <p>{{wrong_folder|length}} {% trans "results found" %}</p>
    {% if wrong_folder %}
    <table class='table table-condensed table-condensed-light'>
    <tr>
        <th style="width:300px;">{% trans "Lemma" %} ({{default_language.name}})</th>
        <th style="width:100px;">{% trans "Gloss ID" %}</th>
        {% for language in dataset_languages %}
        <th style="width:300px;">{% trans "Annotation" %} ({{language.name}})</th>
        {% endfor %}
        <th style="width:1000px;">{% trans "Video Paths" %}</th></tr>
        {% for gloss, videos in wrong_folder %}
        <tr>
            <td>{{gloss.idgloss}}</td>
            <td>{{gloss.id}}</td>
            {% for language in dataset_languages %}
            <td>{{gloss|get_annotation_idgloss_translation_no_default:language}}</td>
            {% endfor %}
            <td>{{videos}}</td></tr>
        {% endfor %}
    </table>
    {% endif %}
    <br>

    <h4>{% trans "Gloss Video Files with non-mp4 Extensions" %}</h4>
    <p>{{non_mp4_videos|length}} {% trans "results found" %}</p>
    {% if non_mp4_videos %}
    <table class='table table-condensed table-condensed-light'>
    <tr>
        <th style="width:300px;">{% trans "Lemma" %} ({{default_language.name}})</th>
        <th style="width:100px;">{% trans "Gloss ID" %}</th>
        {% for language in dataset_languages %}
        <th style="width:300px;">{% trans "Annotation" %} ({{language.name}})</th>
        {% endfor %}
        <th style="width:1000px;">{% trans "Video Paths" %}</th></tr>
        {% for gloss, videos in non_mp4_videos %}
        <tr>
            <td>{{gloss.idgloss}}</td>
            <td>{{gloss.id}}</td>
            {% for language in dataset_languages %}
            <td>{{gloss|get_annotation_idgloss_translation_no_default:language}}</td>
            {% endfor %}
            <td>{{videos}}</td></tr>
        {% endfor %}
    </table>
    {% endif %}
    <br>

    <h4>{% trans "Gloss Videos" %}</h4>
    <p>{{gloss_videos|length}} {% trans "results found" %}</p>
    {% if gloss_videos %}
    <table class='table table-condensed table-condensed-light'>
    <tr>
        <th style="width:300px;">{% trans "Lemma" %} ({{default_language.name}})</th>
        <th style="width:100px;">{% trans "Gloss ID" %}</th>
        {% for language in dataset_languages %}
        <th style="width:300px;">{% trans "Annotation" %} ({{language.name}})</th>
        {% endfor %}
        <th style="width:1000px;">{% trans "Video Paths" %}</th></tr>
        {% for gloss, videos in gloss_videos %}
        <tr>
            <td>{{gloss.idgloss}}</td>
            <td>{{gloss.id}}</td>
            {% for language in dataset_languages %}
            <td>{{gloss|get_annotation_idgloss_translation_no_default:language}}</td>
            {% endfor %}
            <td>{{videos}}</td></tr>
        {% endfor %}
    </table>
    {% endif %}

</div>
{% endblock %}
